Name: nethserver-phonebook-mysql
Version:	@@VERSION@@
Release:	@@RELEASE@@
Summary:	Copy mysql phonebook to LDAP every hour
License:	GPLv2
URL:            %{url_prefix}/%{name} 	
Source0:	%{name}-%{version}.tar.gz
BuildRequires:  nethserver-devtools
Requires:  nethserver-unixODBC
Requires:  nethserver-directory
BuildArch:	noarch

%description
Copy mysql phonebook to LDAP every hour

%prep
%setup -q

%build
perl createlinks
mkdir -p root/home/e-smith/phonebook
mkdir -p root/usr/share/phonebooks/scripts

%install
(cd root   ; /usr/bin/find . -depth -print | /bin/cpio -dump $RPM_BUILD_ROOT)

/sbin/e-smith/genfilelist \
    --file /usr/share/phonebooks/phonebook 'attr(0755,root,root)' \
    --file /usr/share/phonebooks/phonebook2ldap 'attr(0755,root,root)' \
    --file /usr/share/phonebooks/sogo_export.php 'attr(0755,root,root)' \
    $RPM_BUILD_ROOT > %{name}-%{version}-%{release}-filelist

%files -f %{name}-%{version}-%{release}-filelist



%changelog
* Wed May 14 2014 Stefano Fancello <stefano.fancello@nethesis.it> 1.1.1-1nh
- Full working nethserver package
* Tue Apr 29 2014 Stefano Fancello <stefano.fancello@nethesis.it> 1.1.0-1nh
- First NethServer package
* Fri Sep 21 2012 Giacomo Sanchietti <giacomo@nethesis.it> 1.0.11-1nh
- Add space in sogo name contact export and flip name/surname variables
* Mon Jul 30 2012 Giacomo Sanchietti <giacomo@nethesis.it> 1.0.10-2nh
- Make all scripts executable

* Wed Jul 11 2012 Giacomo Sanchietti <giacomo@nethesis.it> 1.0.10-1nh
- Replace all \r with \n in sogo export
- sogo_export: use name and surname for full name
- Workaround for vtiger contacts without name

* Fri Mar 02 2012 Giacomo Sanchietti <giacomo@nethesis.it> 1.0.9-1nh
- Exit with 0 status on phonebook-backup action even if there are no custom scripts

* Tue Feb 28 2012 Giacomo Sanchietti <giacomo@nethesis.it> 1.0.8-1nh
- Fix backup action

* Tue Feb 28 2012 Giacomo Sanchietti <giacomo@nethesis.it> 1.0.7-1nh
- Fix link for pre-backup

* Wed Jan 18 2012 Giacomo Sanchietti <giacomo@nethesis.it> 1.0.6-1nh
- Update vtiger sample script: extract all contacts

* Mon Dec 05 2011 Giacomo Sanchietti <giacomo@nethesis.it> 1.0.5 1
- Really export workphone from SOGo

* Fri Dec 03 2010 Giacomo Sanchietti <giacomo@nethesis.it> 1.0.4 1
- Add ou ldap mapping 

* Fri Nov 05 2010 Giacomo Sanchietti <giacomo@nethesis.it> 1.0.3 1
- Add displayName ldap mapping 

* Wed Sep 29 2010 Giacomo Sanchietti <giacomo@nethesis.it> 1.0.2 2
- Add phonebook to sogo

* Wed Sep 29 2010 Giacomo Sanchietti <giacomo@nethesis.it> 1.0.2 1
- Do not export deleted contacts, add type 'sogo' to exported contacts
- Add vtiger script example  

* Mon Aug 05 2010 Giacomo Sanchietti <giacomo@nethesis.it> 1.0.1 2
- Force ldap schema creation in post install

* Mon Aug 02 2010 Giacomo Sanchietti <giacomo@nethesis.it> 1.0.1 1
- Map some fields from vcard 2.1 to 3.0

* Thu Jul 22 2010 Giacomo Sanchietti <giacomo@nethesis.it> 1.0.0 1
- Major rewrite

* Wed Jul 07 2010 Giacomo Sanchietti <giacomo@nethesis.it> 0.7.1 1
- Fix phonebook position inside slapd.conf

* Tue Jul 06 2010 Giacomo Sanchietti <giacomo@nethesis.it> 0.7 1
- Add ext_phonebook database
- Add sogo phonebook exporter
- Update doc for sogo and ldap
- Add cron template  for sogo and ldap
- Add mysql drive

* Fri Jun 25 2010 Giacomo Sanchietti <giacomo@nethesis.it> 0.6 1
- Add SQL Server support (FreeTDS)

* Fri Jun 18 2010 Giacomo Sanchietti <giacomo@nethesis.it> 0.5 1
- First release
